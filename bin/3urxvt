#!/bin/bash

# 3urxvt - is a script that opens 3 urxvt windows, centered, with specific width/height on specific virtual screen.
# needs 'xrandr','xdotool' and 'awk' < in repos

# illustration
#+---------------------------------------------------+
#|            +-------------------------+            |
#|            |urxvt1                   |            |
#|            |                         |            |
#|            |                         |            |
#|            +-------------------------+            |
#|            +-------------------------+            |
#|            |urxvt2                   |            |
#|            |                         |            |
#|            |                         |            |
#|            +-------------------------+            |
#|            +-------------------------+            |
#|            |urxvt3                   |            |
#|            |                         |            |
#|            |                         |            |
#|            +-------------------------+            |
#+---------------------------------------------------+

# configurable variables
xdotool set_desktop 1   # change me to a desktop you want urxvt windows to open
sleep="0.2"             # sleep before it gets active
w="1000"                # window width
h="360"                 # window height
margin="-5"             # bottom margin
y="50"                  # y pos of first window

# checks
command -v xrandr >/dev/null 2>&1 ||    { >&2 echo "I need xrandr." ; exit 1; }
command -v xdotool >/dev/null 2>&1 ||   { >&2 echo "I need xdotool." ; exit 1; }
command -v awk >/dev/null 2>&1 ||   { >&2 echo "I need awk." ; exit 1; }

# remember what desktop is active now
desknow=$(xdotool get_desktop)

# get screen resolution width and halve it
width=$(xrandr --current | awk '/Screen/ {print $8}')
halfwidth=$((width / 2))

# calc stuff
center=$((halfwidth - w / 2))

echo "halfwidth $halfwidth"     # screen center
echo "center $center"           # the actual x position to move a window to become centered

# action
(urxvt & sleep "$sleep") && xdotool getactivewindow windowsize "$w" "$h" windowmove "$center" "$y"
(urxvt & sleep "$sleep") && xdotool getactivewindow windowsize "$w" "$h" windowmove "$center" $((y + h + margin))
(urxvt & sleep "$sleep") && xdotool getactivewindow windowsize "$w" "$h" windowmove "$center" $((y + 2 * h + 2 * margin))

xdotool set_desktop "$desknow" # return me to original desktop


# notes:
# wmctrl -l < will list all visible window ids
# xdotool windowmove does not support percents, while windowsize does
# urxvtc && sleep "$sleep" && xdotool getactivewindow windowsize 50% 50% windowmove 600 30 < percentage example
